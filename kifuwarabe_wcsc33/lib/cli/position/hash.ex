defmodule KifuwarabeWcsc33.CLI.Position.Hash do
  @moduledoc """
    局面のハッシュ化

    👇 手番に、ハッシュを割り当てる（２箇所）
    ┌────────┬──────────┐
    │ Friend │ Opponent │
    └────────┴──────────┘

    👇 盤の各マスに、ハッシュを割り当てる（８１箇所）
    ┌───┬───┬───┬───┬───┬───┬───┬───┬───┐
    │ 91│   │   │   │   │   │   │   │ 11│
    ├───┼───┼───┼───┼───┼───┼───┼───┼───┤
    │   │   │   │   │   │   │   │   │   │
    ├───┼───┼───┼───┼───┼───┼───┼───┼───┤
    │   │   │   │   │   │   │   │   │   │
    ├───┼───┼───┼───┼───┼───┼───┼───┼───┤
    │   │   │   │   │   │   │   │   │   │
    ├───┼───┼───┼───┼───┼───┼───┼───┼───┤
    │   │   │   │   │   │   │   │   │   │
    ├───┼───┼───┼───┼───┼───┼───┼───┼───┤
    │   │   │   │   │   │   │   │   │   │
    ├───┼───┼───┼───┼───┼───┼───┼───┼───┤
    │   │   │   │   │   │   │   │   │   │
    ├───┼───┼───┼───┼───┼───┼───┼───┼───┤
    │   │   │   │   │   │   │   │   │   │
    ├───┼───┼───┼───┼───┼───┼───┼───┼───┤
    │ 99│   │   │   │   │   │   │   │ 19│
    └───┴───┴───┴───┴───┴───┴───┴───┴───┘

    👇 持ち駒の種類別の枚数に、ハッシュを割り当てる（９０か所）
         ┌───┬───┬───┐
     ▲飛 │  0│  1│  2│
         ├───┼───┼───┤
     ▲角 │  0│  1│  2│
         ├───┼───┼───┼───┬───┐
     ▲金 │  0│  1│  2│  3│  4│
         ├───┼───┼───┼───┼───┤
     ▲銀 │  0│  1│  2│  3│  4│
         ├───┼───┼───┼───┼───┤
     ▲桂 │  0│  1│  2│  3│  4│
         ├───┼───┼───┼───┼───┤
     ▲香 │  0│  1│  2│  3│  4│
         ├───┼───┼───┼───┼───┼───┬───┬───┬───┬───┬───┬───┬───┬───┐───┬───┬───┬───┬───┐
     ▲歩 │  0│  1│  2│  3│  4│  5│  6│  7│  8│  9│ 10│ 11│ 12│ 13│ 14│ 15│ 16│ 17│ 18│
         ├───┼───┼───┼───┴───┴───┴───┴───┴───┴───┘───┴───┴───┴───┴───┘───┴───┴───┴───┘
    ▽飛 │  0│  1│  2│
         ├───┼───┼───┤
    ▽角 │  0│  1│  2│
         ├───┼───┼───┼───┬───┐
    ▽金 │  0│  1│  2│  3│  4│
         ├───┼───┼───┼───┼───┤
    ▽銀 │  0│  1│  2│  3│  4│
         ├───┼───┼───┼───┼───┤
    ▽桂 │  0│  1│  2│  3│  4│
         ├───┼───┼───┼───┼───┤
    ▽香 │  0│  1│  2│  3│  4│
         ├───┼───┼───┼───┼───┼───┬───┬───┬───┬───┬───┬───┬───┬───┐───┬───┬───┬───┬───┐
    ▽歩 │  0│  1│  2│  3│  4│  5│  6│  7│  8│  9│ 10│ 11│ 12│ 13│ 14│ 15│ 16│ 17│ 18│
         └───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘───┴───┴───┴───┴───┘───┴───┴───┴───┘

         合計で１７３箇所分のハッシュを作成する
  """
  @max_int 18_446_744_073_709_551_615

  # * `a..b` - a以上、b以下
  defstruct turn: %{friend: Enum.random(0..@max_int), opponent: Enum.random(0..@max_int)},
            # 盤上の駒
            board: %{
              # １段目
              91 => :l2,
              81 => :n2,
              71 => :s2,
              61 => :g2,
              51 => :k2,
              41 => :g2,
              31 => :s2,
              21 => :n2,
              11 => :l2,
              # ２段目
              92 => :sp,
              82 => :r2,
              72 => :sp,
              62 => :sp,
              52 => :sp,
              42 => :sp,
              32 => :sp,
              22 => :b2,
              12 => :sp,
              # ３段目
              93 => :p2,
              83 => :p2,
              73 => :p2,
              63 => :p2,
              53 => :p2,
              43 => :p2,
              33 => :p2,
              23 => :p2,
              13 => :p2,
              # ４段目
              94 => :sp,
              84 => :sp,
              74 => :sp,
              64 => :sp,
              54 => :sp,
              44 => :sp,
              34 => :sp,
              24 => :sp,
              14 => :sp,
              # ５段目
              95 => :sp,
              85 => :sp,
              75 => :sp,
              65 => :sp,
              55 => :sp,
              45 => :sp,
              35 => :sp,
              25 => :sp,
              15 => :sp,
              # ６段目
              96 => :sp,
              86 => :sp,
              76 => :sp,
              66 => :sp,
              56 => :sp,
              46 => :sp,
              36 => :sp,
              26 => :sp,
              16 => :sp,
              # ７段目
              97 => :p1,
              87 => :p1,
              77 => :p1,
              67 => :p1,
              57 => :p1,
              47 => :p1,
              37 => :p1,
              27 => :p1,
              17 => :p1,
              # ８段目
              98 => :sp,
              88 => :b1,
              78 => :sp,
              68 => :sp,
              58 => :sp,
              48 => :sp,
              38 => :sp,
              28 => :r1,
              18 => :sp,
              # ９段目
              99 => :l1,
              89 => :n1,
              79 => :s1,
              69 => :g1,
              59 => :k1,
              49 => :g1,
              39 => :s1,
              29 => :n1,
              19 => :l1
            }

end
